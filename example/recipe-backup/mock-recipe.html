<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mock Recipe - Alma</title>
    
    <!-- Preload critical fonts -->
    <link rel="preload" href="../fonts/HALFourGrotesk-Regular.otf" as="font" type="font/otf" crossorigin>
    <link rel="preload" href="../fonts/HALFourGrotesk-Medium.otf" as="font" type="font/otf" crossorigin>
    <link rel="preload" href="../fonts/HALFourGrotesk-Bold.otf" as="font" type="font/otf" crossorigin>
    
    <!-- Link to external stylesheet -->
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>


    <!-- Full bleed recipe image -->
    <div class="recipe-image-container">
      <img id="recipe-hero-image" src="../img/food2.png" alt="Recipe Image" class="recipe-image-full">
      <div id="image-gradient-overlay" class="image-gradient-overlay"></div>
    </div>

    <!-- Main content -->
    <div class="container">
      <div class="main-content">
        
        <!-- Recipe Title Section -->
        <div class="recipe-header">
          <h1 class="recipe-title">Crispy Honey Garlic Chicken Thighs</h1>
          <div class="recipe-brand">
            <div class="brand-avatar"></div>
            by <span class="recipe-brand-name">Chef Maria's Kitchen</span>
          </div>
        </div>

        <!-- Macros Card -->
        <div class="macros-card">
          <div class="macros-section">
            <div class="macro-item">
              <div class="macro-label">Cals</div>
              <div class="macro-value">2800</div>
            </div>
            <div class="macro-item">
              <div class="macro-label">Protein</div>
              <div class="macro-value-with-icon">
                <span class="macro-icon protein-icon">P</span>
                <span class="macro-value">180g</span>
              </div>
            </div>
            <div class="macro-item">
              <div class="macro-label">Carbs</div>
              <div class="macro-value-with-icon">
                <span class="macro-icon carbs-icon">C</span>
                <span class="macro-value">362g</span>
              </div>
            </div>
            <div class="macro-item">
              <div class="macro-label">Fat</div>
              <div class="macro-value-with-icon">
                <span class="macro-icon fat-icon">F</span>
                <span class="macro-value">70g</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Ingredients Section -->
        <div class="ingredients-header-container">
          <div class="section-header">
              <h2 class="section-title">Ingredients</h2>
              <span class="section-count">8</span>
            </div>
          <div class="serves-card">
            <img src="../img/person.svg" alt="Person" class="serves-icon" width="19" height="19">
            <span class="serves-text">Serves 1</span>
          </div>
        </div>
        <div class="section-card section-card-ingredients">
          
          
          <div class="ingredient-item">
            <div class="ingredient-left">
              <div class="ingredient-info">
                <div class="ingredient-name">Chicken Thighs</div>
                <div class="ingredient-portion">6 pieces (about 2 lbs)</div>
              </div>
            </div>
            <div class="ingredient-image-container">
              <div class="ingredient-image">üçó</div>
            </div>
          </div>

          <div class="ingredient-item">
            <div class="ingredient-left">
              <div class="ingredient-info">
                <div class="ingredient-name">Honey</div>
                <div class="ingredient-portion">3 tablespoons</div>
              </div>
            </div>
            <div class="ingredient-image-container">
              <div class="ingredient-image">üçØ</div>
            </div>
          </div>

          <div class="ingredient-item">
            <div class="ingredient-left">
              <div class="ingredient-info">
                <div class="ingredient-name">Garlic</div>
                <div class="ingredient-portion">4 cloves, minced</div>
              </div>
            </div>
            <div class="ingredient-image-container">
              <div class="ingredient-image">üßÑ</div>
            </div>
          </div>

          <div class="ingredient-item">
            <div class="ingredient-left">
              <div class="ingredient-info">
                <div class="ingredient-name">Olive Oil</div>
                <div class="ingredient-portion">2 tablespoons</div>
              </div>
            </div>
            <div class="ingredient-image-container">
              <div class="ingredient-image">ü••</div>
            </div>
          </div>

          <div class="ingredient-item">
            <div class="ingredient-left">
              <div class="ingredient-info">
                <div class="ingredient-name">Salt & Pepper</div>
                <div class="ingredient-portion">To taste</div>
              </div>
            </div>
            <div class="ingredient-image-container">
              <div class="ingredient-image">üßÇ</div>
            </div>
          </div>
        </div>

        <!-- Instructions Section -->
        <div class="section-header">
            <h2 class="section-title">Instructions</h2>    
        </div>
        <div class="section-card">
          <div class="instructions-text">1. Preheat your oven to 425¬∞F (220¬∞C). Pat the chicken thighs dry with paper towels and season generously with salt and pepper on both sides.

2. Heat olive oil in a large oven-safe skillet over medium-high heat. Place chicken thighs skin-side down and cook for 5-7 minutes until skin is golden brown and crispy.

3. Flip the chicken thighs and cook for another 3-4 minutes. Remove from heat.

4. In a small bowl, whisk together honey, minced garlic, and a pinch of salt. Pour this mixture over the chicken thighs.

5. Transfer the skillet to the preheated oven and bake for 15-20 minutes, or until internal temperature reaches 165¬∞F (74¬∞C). Let rest for 5 minutes before serving.</div>
        </div>

        <!-- Nutrition Facts Section -->
        <div class="section-header">
            <h2 class="section-title">Nutrition Facts</h2>
          </div>
        <div class="section-card section-card-nutrition">   
          <div class="nutrition-facts">
            <div class="nutrition-row">
              <span class="nutrition-label">Calories</span>
              <div class="nutrition-amount">
                <span class="nutrition-amount-value">385</span>
                <span class="nutrition-amount-unit">kcal</span>
              </div>
            </div>
            <div class="nutrition-row">
              <span class="nutrition-label">Protein</span>
              <div class="nutrition-amount">
                <span class="nutrition-amount-value">42</span>
                <span class="nutrition-amount-unit">g</span>
              </div>
            </div>
            <div class="nutrition-row">
              <span class="nutrition-label">Carbohydrates</span>
              <div class="nutrition-amount">
                <span class="nutrition-amount-value">12</span>
                <span class="nutrition-amount-unit">g</span>
              </div>
            </div>
            <div class="nutrition-row">
              <span class="nutrition-label">Fat</span>
              <div class="nutrition-amount">
                <span class="nutrition-amount-value">28</span>
                <span class="nutrition-amount-unit">g</span>
              </div>
            </div>
            <div class="nutrition-row">
              <span class="nutrition-label">Fiber</span>
              <div class="nutrition-amount">
                <span class="nutrition-amount-value">0</span>
                <span class="nutrition-amount-unit">g</span>
              </div>
            </div>
            <div class="nutrition-row">
              <span class="nutrition-label">Sugar</span>
              <div class="nutrition-amount">
                <span class="nutrition-amount-value">8</span>
                <span class="nutrition-amount-unit">g</span>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Bottom CTA -->
    <div class="bottom-section">
      <div class="cta-container">
        <a href="#" class="app-store-button">
          <svg class="app-icon" viewBox="0 0 24 24">
            <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
          </svg>
          Download Alma to track or save
        </a>
      </div>
    </div>

    <script>
      // Function to extract dominant color from bottom portion of image
      function extractImageColor(img) {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        
        // Sample from bottom 30% of image for better color matching
        const sampleHeight = Math.floor(img.height * 0.3);
        const sampleWidth = img.width;
        
        canvas.width = sampleWidth;
        canvas.height = sampleHeight;
        
        // Draw the bottom portion of the image to canvas
        ctx.drawImage(
          img, 
          0, img.height - sampleHeight, sampleWidth, sampleHeight, // source
          0, 0, sampleWidth, sampleHeight // destination
        );
        
        // Get image data from canvas
        const imageData = ctx.getImageData(0, 0, sampleWidth, sampleHeight);
        const data = imageData.data;
        
        // Calculate average color
        let r = 0, g = 0, b = 0;
        let pixelCount = 0;
        
        // Sample every 4th pixel for performance
        for (let i = 0; i < data.length; i += 16) {
          r += data[i];
          g += data[i + 1];
          b += data[i + 2];
          pixelCount++;
        }
        
        // Calculate averages
        r = Math.floor(r / pixelCount);
        g = Math.floor(g / pixelCount);
        b = Math.floor(b / pixelCount);
        
        return { r, g, b };
      }
      
      // Function to create seamless gradient
      function createSeamlessGradient(dominantColor) {
        const overlay = document.getElementById('image-gradient-overlay');
        const pageBackgroundColor = 'rgb(247, 245, 237)'; // --alma-teriyaki-cream
        
        // Create ultra-gradual gradient for imperceptible transition
        const gradient = `linear-gradient(to bottom,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0) 0%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.02) 15%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.05) 25%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.1) 35%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.18) 45%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.28) 55%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.4) 65%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.55) 75%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.72) 85%,
          rgba(${dominantColor.r}, ${dominantColor.g}, ${dominantColor.b}, 0.9) 95%,
          ${pageBackgroundColor} 100%
        )`;
        
        overlay.style.background = gradient;
      }
      
      // Initialize color extraction when image loads
      function initializeImageGradient() {
        const img = document.getElementById('recipe-hero-image');
        
        if (img.complete) {
          // Image already loaded
          try {
            const dominantColor = extractImageColor(img);
            createSeamlessGradient(dominantColor);
          } catch (error) {
            console.log('Could not extract image color:', error);
          }
        } else {
          // Wait for image to load
          img.onload = function() {
            try {
              const dominantColor = extractImageColor(img);
              createSeamlessGradient(dominantColor);
            } catch (error) {
              console.log('Could not extract image color:', error);
            }
          };
        }
      }
      
      // Run when DOM is loaded
      document.addEventListener('DOMContentLoaded', initializeImageGradient);
    </script>
  </body>
</html>
